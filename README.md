# Hacking CA8271x XGS-PON Stick

Some information has been created with the help of `@stich86_0046`. Thanks!

- Rewrite S/N, Loid, PLOAM, etcâ€¦ for your ISP FTTx
- Rewrite cheap 10G-EPON Stick to XGS-PON Stick

# XGS-PON ONT

| 10GE/XGS-PON ONT | Vender | SoC | OEM | Mgmt IP | Mgmt | Config | URL |
| --- | --- | --- | --- | --- | --- | --- | --- |
| EN-XGSFPP-OMAC | E.C.I Networks | CA8271S | CIG XG-99S | 192.168.100.1 | UART/Telnet | scfg.txt | [Link](https://ecin.ca/xgs-pon-sfp-stick-module-xgspon-ont-w-t-mac-function-mounted-on-sfp-package/) |
| FOX222 | Frontier | CA8271A | CIG XG-99M | 192.168.188.1 | UART | scfg.txt | -   |
| LTF-726x-BH+ | Hisense | CA8271S | -   | 192.168.0.1 | UART/SSH/Web | scfg.txt | [Link](https://www.taobao.com/list/item/658650417501.htm) |
| NSD-G3000T<br>***Separation articles is planned*** | SONY |     | Sercomm MARINER | 192.168.1.1 | UART/Web | gponctl<br>sc\_ft\_data<br>sys_data<br>(unknown) | [Link](https://www.nuro.jp/device.html) |
| HN8255Ws (So-net)<br>***Separation articles is planned*** | Synclayer |     | Huawei | 192.168.1.1 | Web/Telnet | Web (snc_admin) |     |

# Login Password

## EN-XGSFPP-OMAC (XG-99S)

This stick does not have a web console.
To configure it, you must log in via `UART` or `Telnet`.

- UART Baud Rate : `115200 bps`
- Telnet IP : `192.168.100.1:23`

| User | Password |
| --- | --- |
| `PON S/N` | `8digit HMAC-MD5 (PON SN uppercase)` |

Password is generated by `/usr/bin/CigLogin` and `get_pass_by_sn` in `/usr/lib/libvos.so`.
The easiest way to generate a password is to execute the following command from the UART of the appropriate CIG ONU (GPON is also fine)

```
ONT> enable
#ONT> system/debug/md5 "your PON-S/N uppercase" 8
```

For example, if the SN is `ECIG21100005`, the user name and password would be

```
#ONT> system/debug/md5 ECIG21100005 8
MD5 Value: eWsEuWgG
```

- User : `ECIG21100005`
- Password : `eWsEuWgG`

UART does not ask for a login, it is possible to get a root shell without know the password.

## LTF-726x-BH+

This stick have SSH and web console.
but, most settings are not available on the web, plus there is a bug in the PLOAM settings.
To configure it, you must log in via `UART` or `SSH`.

- UART Baud Rate : `115200 bps`
- SSH IP : `192.168.0.1:22`

| User | Password |
| --- | --- |
| `root` | `hbmtsfp` |

## FOX222 (XG-99M)
This ONT does not have a web console.
and, telnet is also not started by default, so you need to start telnetd from UART
To configure it, you must log in via `UART`.

- UART Baud Rate : `115200 bps`
- Telnet IP : `192.168.188.1:23`

| User | Password |
| --- | --- |
| `unknown` | `8digit HMAC-MD5 (PON SN uppercase)` |

Password is generated by `/usr/bin/CigLogin` and `get_pass_by_sn` in `/usr/lib/libvos.so`.
The easiest way to generate a password is to execute the following command from the UART of the appropriate CIG ONU (GPON is also fine)

```
ONT> enable
#ONT> system/debug/md5 "your PON-S/N uppercase" 8
```

For example, if the SN is `ECIG21100005`, the user name and password would be
```
#ONT> system/debug/md5 ECIG21100005 8
MD5 Value: eWsEuWgG
```
- User : `ECIG21100005`
- Password : `eWsEuWgG`

This ont does not know the username and currently there is no way to login via telnet.
but, UART does not ask for a login, it is possible to get a root shell without know the password.

## NSD-G3000T

This ONT have a web console.
But this ont doesn't know the username of the telecom admin,
to configure it, you must log in via `UART`.

- Web IP : `192.168.188.1`
- UART Baud Rate : `115200 bps`

| User | Password |
| --- | --- |
| `unknown` | `admin_super_"your PON-MAC last 4 digit lowercase"` |

This ont does not know the telecomadmin username and currently there is no way to login via WebGui.
but, UART does not ask for a login, it is possible to get a root shell without know the password.

## HN8255Ws (So-net)

This ONT have Telnet snd web console.
Many items are configurable in the `Web`

- Web IP : `192.168.1.1`
- UART Baud Rate : `115200 bps`

| User | Password |
| --- | --- |
| `snc_admin` | `So-net_n21r15_"your PON-MAC last 4 digit uppercase"` |

# UART pin
The following link summarizes UART pin.

- Link

# scfg.txt
CA8271x SoC reads the configuration from the `default_scfg.txt` and `scfg.txt` files.

These files are usually found under `/config/` 
but, some sticks are dynamically generated according to their custom configuration area in ROM,
or are set to read-only, so you may need to edit `sfcg.txt`, which is stored in a different path.

To obtain scfg.txt for each ONT, see the following links.

- Link

## EN-XGSFPP-OMAC, FOX222 (XG-99x)
In the XG-99x series ONT, the settings are loaded by four scfg.txt files.
For rewriting settings, `/userdata/scfg.txt` and `/tmp/scfg.txt` are used.

- `/config/default_scfg.txt`  (ReadOnly)
Contains the manufacturer's default settings,
which are read first at ONT startup and are the lowest priority settings.
<br>
- `/config/scfg.txt` (ReadOnly)
Contains settings set by the firmware creator,
which have higher priority than default_scfg.txt and will overwrite the settings if there is a conflict.
Nothing entry in EN-XGSFPP-OMAC Stick.
<br>
- `/userdata/scfg.txt` (RW)
Contains settings set by the user or ISP.
It has a higher priority than /config/scfg.txt and will overwritte the settings if there is a conflict.
Can be edited and saved.
<br>
- `/tmp/scfg.txt` (Can't Save)
It contains dynamically generated settings based on values stored on its custom ROM (mtd9, mtd10)
Since they are generated on tmpfs and cannot be saved directly,
they are rewritten via the `#ONT> system/misc` command on the ONT.
<br>

The settings are overwritten and loaded at startup with the following priority.

***(High)*** `/tmp/scfg.txt` > `/userdata/scfg.txt` > `/config/scfg.txt` > `/config/default_scfg.txt` ***(Low)***

## LTF-726x-BH+
In the LTF-726x-BH+ series ONT, the settings are loaded by two scfg.txt files.
For rewriting settings `/config/scfg.txt` are used.

- `/config/default_scfg.txt`  (RW)
Contains the manufacturer's default settings,
which are read first at ONT startup and are the lowest priority settings.
They can be edited, but must not be rewritten.
<br>
- `/config/scfg.txt` (RW)
Contains settings set by the user or ISP.
It has a higher priority than /config/scfg.txt and will overwritte the settings if there is a conflict.
Can be edited and saved.
<br>

The settings are overwritten and loaded at startup with the following priority.

***(High)***  `/config/scfg.txt` > `/config/default_scfg.txt` ***(Low)***

# How to get root CLI & root Shell
## LTF-726x-BH+
Connect via `SSH` or `UART` to obtain root shell.

## EN-XGSFPP-OMAC, FOX222 (XG-99x)
After logging in via `telnet` or `UART`, you will first get the CLI with user privileges.
```
ONT>
```
The root CLI can be obtained by executing the `enable` command on this CLI.
```
ONT> enable
#ONT>
```
The root shell can be obtained by executing the following command in the root CLI.
```
#ONT> system/shell
#ONT/System/Shell> sh
#
```

There are several other commands in the root CLI.
The following is a list of typical commands,

- `/traffic/pon/show onu`
Obtain ont's authentication status, SN, LOID password, PLOAM password, etc.
<br>
- `/system/misc`
Change the SN, vendor, PLOAM password, and other settings stored in its custom ROM (mtd9, mtd10)
<br>
- `/system/mib/show "MIB No."`
Get MIB values.
example,
`#ONT> /system/mib/show 256`
`/system/mib/show ?` command can get a list of supported MIBs.
<br>

# ONT config
## EN-XGSFPP-OMAC, FOX222 (XG-99x)
XG-99x series ONT uses scfg.txt file and misc command for configuration.

In the XG-99x series ONT, the MIB OntG Vendor can be set to a value different from the S/N Vendor value.
example,
`S/N : ECIG01234567`
`Vendor : ZTEG`

Configuration by misc command.
- PON S/N
- PON S/N Vendor Code
- MIB OntG (256) Vendor Code
- Loid Password
- PLOAM Password
- FW Version
- HW Version
- Manufacture Vendor
- Product Code
- Product Serial
- Product ID
- MAC Address
- Management IP

Configuration by scfg.txt
- PON Mode
- Loid User
- OLT mode
- OMCC Version
- etc...

The following link summarizes  XG-99x series ONT configuration.
- Link

## LTF-726x-BH+
LTF-726x-BH+ series ONT uses scfg.txt file for configuration.

The following link summarizes  XG-99x series ONT configuration.
- Link


# This document is a work in progress. More updates will follow.